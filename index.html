<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sorpresa para Mi esposita</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#f59e0b;--muted:#94a3b8}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef8;background:linear-gradient(160deg,var(--bg),#071126);}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:28px;border-radius:16px;max-width:720px;width:100%;box-shadow:0 8px 30px rgba(2,6,23,0.7)}
    h1{margin:0 0 8px;font-size:26px}
    p.lead{color:var(--muted);margin-top:0}
    .choices{display:flex;flex-direction:column;gap:12px;margin-top:18px}
    button.opt{background:transparent;border:2px solid rgba(255,255,255,0.06);padding:12px 16px;border-radius:10px;text-align:left;color:#e6eef8;font-weight:600;cursor:pointer}
    button.opt:hover{border-color:var(--accent);transform:translateY(-2px)}
    .small{font-size:13px;color:var(--muted)}
    .back{margin-top:12px;background:none;border:0;color:var(--muted);cursor:pointer}
    .gift{margin-top:18px;padding:16px;border-radius:12px;background:rgba(255,255,255,0.02);text-align:center}
    .confetti{position:fixed;left:0;right:0;top:0;bottom:0;pointer-events:none}
    img.gift-img {
      max-width: 100%;
      border-radius: 10px;
      margin-top: 12px;
      filter: blur(20px);              /* empieza borrosa */
      transition: filter 5s ease-out;  /* animaci√≥n de 5 segundos */
    }
    img.gift-img.reveal {
      filter: blur(0px);               /* termina n√≠tida */
    }
    footer{margin-top:18px;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <main class="card" id="app">
      <header>
        <h1 id="title">¬°Feliz cumplea√±os, Mi esposita!</h1>
        <p class="lead" id="subtitle">Bienvenida a tu aventura sorpresa‚Ä¶ cada elecci√≥n te acerca a tu regalo.</p>
      </header>
      <section id="scene" aria-live="polite"></section>
      <footer>
        <p class="small">Creado con cari√±o. üíñ</p>
      </footer>
    </main>
  </div>
  <canvas class="confetti" id="confettiCanvas"></canvas>

  <script>
    const CONFIG = {
      birthdayName: 'Mi esposita',
      startTitle: 'Una Aventura para {name}',
      startSubtitle: 'Cada decisi√≥n te acerca a tu regalo‚Ä¶',
      coverImage: '',
      scenes: {
        start: {
          text: 'Hoy es un d√≠a especial‚Ä¶ encuentras una nota que dice: ‚ÄúSigue las pistas, y al final viajar√°s‚Äù. ¬øQu√© haces primero?',
          choices:[
            {text:'Leer la nota', to:'nota'},
            {text:'Salir al sal√≥n', to:'salon'}
          ]
        },
        nota: {
          text: 'La nota dice: ‚ÄúDonde el sol besa las pir√°mides, ah√≠ te espera tu destino‚Äù. ¬øHacia d√≥nde vas?',
          choices:[
            {text:'Buscar fotos del viaje', to:'fotos'},
            {text:'Salir al balc√≥n', to:'balcon'}
          ]
        },
        salon: {
          text: 'En el sal√≥n ves un mapa de Egipto en la mesa. Pareciera una pista‚Ä¶',
          choices:[
            {text:'Estudiar el mapa', to:'mapa'},
            {text:'Regresar y leer nota', to:'nota'}
          ]
        },
        fotos: {
          text: 'Ves fotos hermosas del desierto, el Nilo, las pir√°mides‚Ä¶ el viaje so√±ado. Pero a√∫n no es el momento. Sigues buscando.',
          choices:[
            {text:'Regresar al sal√≥n', to:'salon'},
            {text:'Volver al inicio', to:'start'}
          ]
        },
        mapa: {
          text: 'Seg√∫n el mapa, debes ir al lugar m√°s alto del balc√≥n‚Ä¶ ah√≠ estar√° la sorpresa.',
          choices:[
            {text:'Ir al balc√≥n', to:'balcon'},
            {text:'Seguir buscando en casa', to:'salon'}
          ]
        },
        balcon: {
          text: 'En el balc√≥n, entre flores y estrellas, aparece una imagen m√°gica...',
          choices:[
            {text:'Ver el regalo', to:'final'}
          ]
        },
        final: {
          text: '¬°Sorpresa! Este viaje a Egipto es tu regalo: templos, desiertos, el Nilo y aventuras contigo. üéâ',
          choices:[]
        }
      },
      finalMessage: 'Mi esposita, este viaje es para ti. ¬°Feliz cumplea√±os! üåç',
      giftImage: 'https://images.unsplash.com/photo-1613932534449-3d1cc403a53a'
    }

    function t(s){ return s.replace(/{name}/g, CONFIG.birthdayName) }
    document.getElementById('title').innerText = t(CONFIG.startTitle)
    document.getElementById('subtitle').innerText = t(CONFIG.startSubtitle)
    const sceneEl = document.getElementById('scene')

    function render(id){
      const scene = CONFIG.scenes[id]
      sceneEl.innerHTML = ''
      const p = document.createElement('p')
      p.className = 'small'
      p.innerText = scene.text
      sceneEl.appendChild(p)

      if(id==='start' && CONFIG.coverImage){
        const img = document.createElement('img')
        img.className = 'cover'
        img.src = CONFIG.coverImage
        sceneEl.appendChild(img)
      }

      const choices = document.createElement('div')
      choices.className = 'choices'
      scene.choices.forEach(c => {
        const b = document.createElement('button')
        b.className = 'opt'
        b.innerText = c.text
        b.addEventListener('click', () => render(c.to))
        choices.appendChild(b)
      })
      sceneEl.appendChild(choices)

      if(scene.choices.length === 0){
        const gift = document.createElement('div')
        gift.className = 'gift'
        const msg = document.createElement('div')
        msg.innerHTML = `<strong>${t(CONFIG.finalMessage)}</strong><p class="small">${scene.text}</p>`
        gift.appendChild(msg)
        if(CONFIG.giftImage){
          const img = document.createElement('img')
          img.className = 'gift-img'
          img.src = CONFIG.giftImage
          gift.appendChild(img)
          // activar desenfoque progresivo
          setTimeout(() => img.classList.add('reveal'), 100)
        }
        sceneEl.appendChild(gift)
        launchConfetti()
      }

      if(id !== 'start'){
        const back = document.createElement('button')
        back.className = 'back'
        back.innerText = '‚Üê Volver'
        back.addEventListener('click', () => render('start'))
        sceneEl.appendChild(back)
      }
    }

    function launchConfetti(){
      const canvas = document.getElementById('confettiCanvas')
      const ctx = canvas.getContext('2d')
      canvas.width = window.innerWidth
      canvas.height = window.innerHeight
      const pieces = []
      const colors = ['#f59e0b','#f97316','#fb923c','#fde68a','#fff']
      for(let i=0;i<130;i++){
        pieces.push({ x: Math.random()*canvas.width, y: Math.random()*-canvas.height, vy:2+Math.random()*4, angle:Math.random()*360, r:2+Math.random()*6, c: colors[Math.floor(Math.random()*colors.length)] })
      }
      let tcount = 0
      function frame(){
        tcount++
        ctx.clearRect(0,0,canvas.width,canvas.height)
        pieces.forEach(p => {
          p.x += Math.sin((p.y + tcount)/20)*1.5
          p.y += p.vy
          ctx.fillStyle = p.c
          ctx.save()
          ctx.translate(p.x, p.y)
          ctx.rotate((p.angle + tcount/3) * Math.PI/180)
          ctx.fillRect(-p.r/2, -p.r/2, p.r, p.r*1.6)
          ctx.restore()
          if(p.y > canvas.height + 20){
            p.y = -20
            p.x = Math.random() * canvas.width
          }
        })
        if(tcount < 800) requestAnimationFrame(frame)
      }
      frame()
    }

    render('start')
  </script>
</body>
</html>
